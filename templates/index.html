{% extends "base_user.html" %}

{% block title %}Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù…Ù„ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©{% endblock %}

{% block content %}
<div class="card p-4 shadow-sm">
    <h3 class="mb-4 text-center">Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù…Ù„ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</h3>

    <form action="/confirm" method="post">
        <div class="mb-3">
            <label class="form-label fw-bold">Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø¢Ø®Ø± 4 Ø£Ø±Ù‚Ø§Ù…)</label>
            <input type="text" class="form-control" name="trx_last4" id="trx_last4" placeholder="Ù…Ø«Ø§Ù„: 4892" required
                        oninput="autoFillDate()">
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª</label>
            <input type="text" class="form-control" name="date_time" id="date_time" readonly>
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">Ø§Ù„Ù…Ø¨Ù„Øº</label>
            <input type="number" step="0.01" class="form-control" name="amount" required>
        </div>

        <div class="d-flex flex-column gap-2">
            <button type="submit" class="btn btn-save-op">Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</button>

            <a href="/transactions" class="btn btn-view-txns">
                Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            </a>
        </div>
    </form>
</div>

<style>
    /* 1. Ø²Ø± Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø§Ù„Ø£Ø®Ø¶Ø± Ø§Ù„Ù…ØµÙØ± #a1bf37) */
    .btn-save-op {
        background-color: #a1bf37;
        border-color: #a1bf37;
        color: #fff;
    }
    .btn-save-op:hover,
    .btn-save-op:focus {
        background-color: #8c9b2f; /* Ø¯Ø±Ø¬Ø© Ø£ØºÙ…Ù‚ Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ§Ø¹Ù„ */
        border-color: #8c9b2f;
        color: #fff;
    }

    /* 2. Ø²Ø± Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© (Ø§Ù„Ø¨Ù†ÙØ³Ø¬ÙŠ Ø§Ù„Ø¯Ø§ÙƒÙ† #59287f) */
    .btn-view-txns {
        background-color: #59287f;
        border-color: #59287f;
        color: #fff;
    }
    .btn-view-txns:hover,
    .btn-view-txns:focus {
        background-color: #4a1f6a; /* Ø¯Ø±Ø¬Ø© Ø£ØºÙ…Ù‚ Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ§Ø¹Ù„ */
        border-color: #4a1f6a;
        color: #fff;
    }
</style>

<script>
function autoFillDate() {
    const now = new Date();
    
    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®: YYYY-MM-DD
    const datePart = now.getFullYear() + "-" +
                     String(now.getMonth() + 1).padStart(2, '0') + "-" +
                     String(now.getDate()).padStart(2, '0');
    
    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª: HH:MM:SS (ØµÙŠØºØ© 24 Ø³Ø§Ø¹Ø©)
    const timePart = String(now.getHours()).padStart(2, '0') + ":" +
                     String(now.getMinutes()).padStart(2, '0') + ":" +
                     String(now.getSeconds()).padStart(2, '0');

    // ğŸŸ¢ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„: Ø§Ù„ØªÙˆØ­ÙŠØ¯ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ ØªÙ†Ø³ÙŠÙ‚ Python: YYYY-MM-DD HH:MM:SS
    const formatted = datePart + " " + timePart; 

    document.getElementById("date_time").value = formatted;
}

// ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø­Ù‚Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø£ÙŠØ¶Ù‹Ø§ (Ù…Ù† Ø®Ù„Ø§Ù„ Ù‚ÙŠÙ…Ø© Jinja Ø§Ù„Ù…Ø±Ø³Ù„Ø© Ù…Ù† Ø¯Ø§Ù„Ø© index ÙÙŠ main.py)
// Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù‡Ùˆ index.htmlØŒ ÙØ³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚Ù„ Ø¹Ø¨Ø±:
// document.getElementById("date_time").value = "{{ data.date_time }}";
// ... Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚Ù„ØŒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© Run On Load Ù„ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠØ©.
</script>
{% endblock %}
